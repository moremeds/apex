# Trading Signal Rules Configuration
# Defines rules for generating trading signals from indicators

version: 1

# Default settings for all rules
defaults:
  cooldown_seconds: 3600  # 1 hour
  enabled: true

# Momentum rules
momentum_rules:
  rsi_oversold_exit:
    indicator: rsi
    direction: buy
    strength: 70
    priority: high
    condition_type: state_change
    condition_config:
      field: zone
      from: [oversold]
      to: [neutral]
    message_template: "{symbol} RSI exiting oversold zone"

  rsi_overbought_exit:
    indicator: rsi
    direction: sell
    strength: 70
    priority: high
    condition_type: state_change
    condition_config:
      field: zone
      from: [overbought]
      to: [neutral]
    message_template: "{symbol} RSI exiting overbought zone"

  macd_bullish_cross:
    indicator: macd
    direction: buy
    strength: 60
    priority: medium
    condition_type: cross_up
    condition_config:
      line_a: macd
      line_b: signal
    message_template: "{symbol} MACD bullish crossover"

  macd_bearish_cross:
    indicator: macd
    direction: sell
    strength: 60
    priority: medium
    condition_type: cross_down
    condition_config:
      line_a: macd
      line_b: signal
    message_template: "{symbol} MACD bearish crossover"

  # Dual MACD rules (overlapping 55/89 and 13/21)
  dual_macd_trend_confirm_bullish:
    indicator: dual_macd
    direction: buy
    strength: 75
    priority: high
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [trend_confirmation_bullish]
    message_template: "{symbol} DualMACD: Trend confirmed bullish (both histograms positive)"

  dual_macd_trend_confirm_bearish:
    indicator: dual_macd
    direction: sell
    strength: 75
    priority: high
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [trend_confirmation_bearish]
    message_template: "{symbol} DualMACD: Trend confirmed bearish (both histograms negative)"

  dual_macd_momentum_entry_bullish:
    indicator: dual_macd
    direction: buy
    strength: 70
    priority: high
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [bullish_momentum_entry]
    message_template: "{symbol} DualMACD: Bullish entry (short histogram up, long trend intact)"

  dual_macd_momentum_entry_bearish:
    indicator: dual_macd
    direction: sell
    strength: 70
    priority: high
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [bearish_momentum_entry]
    message_template: "{symbol} DualMACD: Bearish entry (short histogram down, long trend intact)"

  dual_macd_divergence_bullish_warning:
    indicator: dual_macd
    direction: alert
    strength: 65
    priority: medium
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [momentum_divergence_bullish_warning]
    message_template: "{symbol} DualMACD: Bullish divergence warning (short positive, long negative)"

  dual_macd_divergence_bearish_warning:
    indicator: dual_macd
    direction: alert
    strength: 65
    priority: medium
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [momentum_divergence_bearish_warning]
    message_template: "{symbol} DualMACD: Bearish divergence warning (short negative, long positive)"

  dual_macd_overbought_in_uptrend:
    indicator: dual_macd
    direction: alert
    strength: 60
    priority: medium
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [overbought_in_uptrend]
    message_template: "{symbol} DualMACD: Overbought within uptrend (short stretched vs long)"

  dual_macd_oversold_in_downtrend:
    indicator: dual_macd
    direction: alert
    strength: 60
    priority: medium
    condition_type: state_change
    condition_config:
      field: signal_type
      from: [null]
      to: [oversold_in_downtrend]
    message_template: "{symbol} DualMACD: Oversold within downtrend (short stretched vs long)"

# Trend rules
trend_rules:
  supertrend_bullish:
    indicator: supertrend
    direction: buy
    strength: 75
    priority: high
    condition_type: state_change
    condition_config:
      field: direction
      from: [bearish]
      to: [bullish]
    message_template: "{symbol} SuperTrend turned bullish"

  supertrend_bearish:
    indicator: supertrend
    direction: sell
    strength: 75
    priority: high
    condition_type: state_change
    condition_config:
      field: direction
      from: [bullish]
      to: [bearish]
    message_template: "{symbol} SuperTrend turned bearish"

  ema_golden_cross:
    indicator: ema
    direction: buy
    strength: 65
    priority: high
    condition_type: cross_up
    condition_config:
      line_a: ema_fast
      line_b: ema_slow
    message_template: "{symbol} EMA golden cross (fast > slow)"

  ema_death_cross:
    indicator: ema
    direction: sell
    strength: 65
    priority: high
    condition_type: cross_down
    condition_config:
      line_a: ema_fast
      line_b: ema_slow
    message_template: "{symbol} EMA death cross (fast < slow)"

# Volatility rules
volatility_rules:
  bollinger_oversold:
    indicator: bollinger
    direction: buy
    strength: 55
    priority: medium
    condition_type: state_change
    condition_config:
      field: zone
      from: [below_lower]
      to: [inside]
    message_template: "{symbol} price bouncing from lower Bollinger Band"

  bollinger_overbought:
    indicator: bollinger
    direction: sell
    strength: 55
    priority: medium
    condition_type: state_change
    condition_config:
      field: zone
      from: [above_upper]
      to: [inside]
    message_template: "{symbol} price rejecting upper Bollinger Band"

  squeeze_release:
    indicator: squeeze
    direction: alert
    strength: 80
    priority: high
    condition_type: state_change
    condition_config:
      field: squeeze
      from: [on]
      to: [off]
    message_template: "{symbol} Bollinger/Keltner squeeze releasing"

# Volume rules
volume_rules:
  volume_spike:
    indicator: volume_ratio
    direction: alert
    strength: 60
    priority: medium
    condition_type: threshold_cross_up
    condition_config:
      field: ratio
      threshold: 2.0
    message_template: "{symbol} volume spike detected (2x average)"

  obv_divergence_bullish:
    indicator: obv
    direction: buy
    strength: 65
    priority: medium
    condition_type: state_change
    condition_config:
      field: divergence
      from: [none]
      to: [bullish]
    message_template: "{symbol} bullish OBV divergence"
