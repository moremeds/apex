# Label Horizon Example
#
# Demonstrates:
# - Using label_horizon_days for multi-day trade strategies
# - Dynamic purge gap calculation based on trade resolution time
# - Swing trading parameters
#
# For strategies where trades take multiple days to resolve (swing trading,
# position trading), the purge gap must be at least as long as the trade
# duration to prevent data leakage from future trade outcomes.
#
# effective_purge = max(purge_days, label_horizon_days)
#
# Run with:
#   python -m src.runners.systematic_backtest_runner --spec config/backtest/examples/03_label_horizon.yaml

name: "Label_Horizon_Example"
description: "Swing trading strategy with proper purge gap for multi-day trades"
strategy: "swing_trading"

parameters:
  # Entry/exit thresholds
  entry_rsi:
    type: range
    min: 20
    max: 35
    step: 5
  exit_rsi:
    type: range
    min: 65
    max: 80
    step: 5

  # Maximum holding period affects label horizon
  max_hold_days:
    type: categorical
    values: [5, 10, 15, 20]

  # Stop loss percentage
  stop_loss_pct:
    type: categorical
    values: [0.03, 0.05, 0.07]

universe:
  type: static
  symbols:
    - SPY      # S&P 500 ETF
    - QQQ      # Nasdaq ETF
    - IWM      # Russell 2000 ETF

temporal:
  primary_method: walk_forward
  train_days: 504           # 2 years training (needed for swing strategies)
  test_days: 126            # 6 months testing
  folds: 4

  # Purge configuration with label horizon
  purge_days: 5             # Minimum purge gap
  embargo_days: 2
  label_horizon_days: 20    # Trades may take up to 20 days to resolve
  # Effective purge = max(5, 20) = 20 trading days

  start_date: "2019-01-01"
  end_date: "2025-12-30"

optimization:
  method: grid
  metric: calmar            # Calmar ratio (return/max drawdown)
  direction: maximize
  constraints:
    - metric: p10_sharpe
      operator: ">="
      value: 0.3
    - metric: median_max_dd
      operator: "<="
      value: 0.15           # Tighter drawdown for swing trading
    - metric: total_trades
      operator: ">="
      value: 20             # Minimum trades for statistical significance

profiles:
  swing:
    name: swing_realistic
    version: v1
    slippage_bps: 10.0      # Higher slippage for less liquid moments
    commission_per_share: 0.01
    fill_model: vwap
    volume_limit_pct: 0.02  # Conservative volume participation

reproducibility:
  random_seed: 42
  data_version: "apex_2024.12"
