# PulseDip Strategy - TrendPulse + DualMACD Confluence
#
# Tier 1 strategy: Buy dips in confirmed uptrends.
# Combines EMA trend filter + RSI dip detection + regime gating.
#
# Run with:
#   python -m src.backtest.runner --strategy pulse_dip --symbols AAPL NVDA MSFT --start 2022-01-01 --end 2025-06-30
#   python -m src.backtest.runner --spec config/backtest/playbook/pulse_dip.yaml

name: "PulseDip_Backtest"
description: "TrendPulse + DualMACD confluence dip-buying strategy"
strategy: "pulse_dip"

parameters:
  ema_trend_period:
    type: range
    min: 50
    max: 200
    step: 25
  rsi_period:
    type: fixed
    value: 14
  rsi_entry_threshold:
    type: range
    min: 25
    max: 45
    step: 5
  atr_stop_mult:
    type: range
    min: 2.0
    max: 4.0
    step: 0.5
  min_confluence_score:
    type: fixed
    value: 20
  max_hold_bars:
    type: fixed
    value: 40
  risk_per_trade_pct:
    type: fixed
    value: 0.02

universe:
  type: static
  symbols:
    - AAPL
    - NVDA
    - MSFT
    - AMZN
    - GOOGL

temporal:
  primary_method: walk_forward
  train_days: 504          # 2 years training
  test_days: 126           # 6 months testing
  folds: 4
  purge_days: 5
  embargo_days: 2
  start_date: "2020-01-01"
  end_date: "2025-06-30"

optimization:
  method: optuna
  metric: sharpe
  direction: maximize
  n_trials: 50
  constraints:
    - metric: p10_sharpe
      operator: ">="
      value: 0.0
    - metric: median_max_dd
      operator: "<="
      value: 0.20

profiles:
  default:
    name: tier_a
    version: v1
    slippage_bps: 5.0
    commission_per_share: 0.005
    fill_model: close
  conservative:
    name: tier_b
    version: v1
    slippage_bps: 15.0
    commission_per_share: 0.005
    fill_model: next_open

reproducibility:
  random_seed: 42
  data_version: "apex_2025.01"
