{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://apex.trading/schemas/indicator_output.schema.json",
  "title": "IndicatorOutput",
  "description": "Schema for individual indicator calculation output",
  "type": "object",
  "required": ["indicator", "category", "timestamp", "symbol", "timeframe", "warmup_complete", "outputs"],
  "properties": {
    "indicator": {
      "type": "string",
      "description": "Indicator name (e.g., 'rsi', 'macd', 'supertrend')",
      "minLength": 1
    },
    "category": {
      "type": "string",
      "enum": ["momentum", "trend", "volatility", "volume", "pattern", "regime"],
      "description": "Indicator category"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Bar timestamp in ISO 8601 format"
    },
    "symbol": {
      "type": "string",
      "description": "Trading symbol",
      "minLength": 1
    },
    "timeframe": {
      "type": "string",
      "enum": ["1m", "5m", "15m", "30m", "1h", "4h", "1d", "1w"],
      "description": "Bar timeframe"
    },
    "warmup_complete": {
      "type": "boolean",
      "description": "True if indicator warmup period has elapsed"
    },
    "outputs": {
      "type": "object",
      "description": "Indicator-specific output values",
      "additionalProperties": true,
      "minProperties": 1
    },
    "metadata": {
      "type": "object",
      "description": "Optional additional metadata",
      "additionalProperties": true
    }
  },
  "$defs": {
    "momentum_outputs": {
      "description": "Common momentum indicator outputs",
      "type": "object",
      "properties": {
        "value": {"type": "number"},
        "zone": {
          "type": "string",
          "enum": ["overbought", "oversold", "neutral", "extreme_high", "extreme_low"]
        },
        "direction": {
          "type": "string",
          "enum": ["up", "down", "flat"]
        }
      }
    },
    "trend_outputs": {
      "description": "Common trend indicator outputs",
      "type": "object",
      "properties": {
        "value": {"type": "number"},
        "direction": {"type": "integer", "enum": [-1, 0, 1]},
        "trend": {
          "type": "string",
          "enum": ["bullish", "bearish", "neutral"]
        }
      }
    },
    "volatility_outputs": {
      "description": "Common volatility indicator outputs",
      "type": "object",
      "properties": {
        "value": {"type": "number", "minimum": 0},
        "upper_band": {"type": "number"},
        "lower_band": {"type": "number"},
        "state": {
          "type": "string",
          "enum": ["high", "normal", "low", "squeeze"]
        }
      }
    }
  }
}
